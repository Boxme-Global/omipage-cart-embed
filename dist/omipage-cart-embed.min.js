"use strict";!function(t){class e{constructor(t,e,a,i,r,c){this.sku=t,this.name=e,this.price=a,this.discounted_price=i,this.image=r,this.quantity=c}total_amount(){return self.quantity*self.price}increase_quantity(t=1){this.quantity+=t}}t.Cart=class{constructor(){this.items=[],this.load_cart_from_storage()}uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}add_item_to_cart(t){var e=this.find(t.sku);if(!e)return this.items.push(t),void this.save_cart();var a=this.items.indexOf(e);e.increase_quantity(t.quantity),this.items[a]=e,this.save_cart()}find(t){return this.items.find((e=>e.sku==t))}total_quantity(){var t=0;return this.items.forEach(((e,a)=>{t+=e.quantity})),t}has(t){return null!=this.find(t)}clear_cart(){this.items=[],this.save_cart()}save_cart(){t.localStorage.setItem("omp_cart",JSON.stringify(this.items)),document.dispatchEvent(new CustomEvent("cart_changed",{bubbles:!0},{detail:"Event change cart"}))}load_cart_from_storage(){this.items=[];var a=JSON.parse(t.localStorage.getItem("omp_cart"));if(a)for(var i in a){var r=new e(a[i].sku,a[i].name,Number(a[i].price),Number(a[i].discounted_price),a[i].image,Number(a[i].quantity));this.items.push(r)}this.omp_cart_id=t.localStorage.getItem("omp_cart_id"),this.omp_cart_id||(this.omp_cart_id=this.uuidv4(),t.localStorage.setItem("omp_cart_id",this.omp_cart_id))}},t.Omipage=class{constructor(t){this.cart=t,this.cart_quantity_els=document.querySelectorAll('[data-cart-quantity="true"]'),this.add_to_cart_btns=document.querySelectorAll('[data-action="add_to_cart"]'),this.checkout_btns=document.querySelectorAll('[data-action="checkout"]'),this.store_page_key(),this.store_page_title()}binding_cart_quantity(){var t=this;this.cart_quantity_els.forEach((e=>{e.innerHTML=t.cart.total_quantity()})),document.addEventListener("cart_changed",(e=>{t.cart_quantity_els.length>0&&(t.cart_quantity_els[0].innerHTML=cart.total_quantity())}))}binding_add_to_cart_button(){var a=function(a){var i,r,c,n,s,o,u,_=this,d="checkout"==_.getAttribute("data-action");_.getAttribute("data-action");if(i=_.getAttribute("data-name"),r=_.getAttribute("data-sku"),c=Number(_.getAttribute("data-quantity")),n=Number(_.getAttribute("data-price")),s=Number(_.getAttribute("data-discounted-price")),o=_.getAttribute("data-image"),u=_.getAttribute("data-append-to-cart"),console.log("clicked",d),d&&"false"==u&&cart.clear_cart(),i&&r&&c&&n&&s){var m=new e(r,i,n,s,o,c);cart.add_item_to_cart(m)}d&&(t.location="/checkout?cart="+t.localStorage.getItem("omp_cart_id"))};this.add_to_cart_btns.forEach((t=>{t.addEventListener("click",a)})),this.checkout_btns.forEach((t=>{t.addEventListener("click",a)}))}get_meta(t){const e=document.getElementsByTagName("meta");for(let a=0;a<e.length;a++)if(e[a].getAttribute("name")===t)return e[a].getAttribute("content");return""}store_page_key(){localStorage.setItem("omp_key",this.get_meta("omp_key"))}store_page_title(){localStorage.setItem("omp_title",document.title)}}}(window);var cart=new Cart,omipage=new Omipage(cart);omipage.binding_add_to_cart_button(),omipage.binding_cart_quantity();
