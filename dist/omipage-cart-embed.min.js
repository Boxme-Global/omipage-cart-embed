"use strict";class Item{constructor(t,a,e,r,i,c){this.sku=t,this.name=a,this.price=e,this.discounted_price=r,this.image=i,this.quantity=c}total_amount(){return self.quantity*self.price}increase_quantity(t=1){this.quantity+=t}}class Cart{constructor(){this.items=[],this.load_cart_from_storage()}uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=16*Math.random()|0;return("x"==t?a:3&a|8).toString(16)}))}add_item_to_cart(t){var a=this.find(t.sku);if(!a)return this.items.push(t),void this.save_cart();var e=this.items.indexOf(a);a.increase_quantity(t.quantity),this.items[e]=a,this.save_cart()}find(t){return this.items.find((a=>a.sku==t))}total_quantity(){var t=0;return this.items.forEach(((a,e)=>{t+=a.quantity})),t}has(t){return null!=this.find(t)}clear_cart(){this.items=[],this.save_cart()}save_cart(){window.localStorage.setItem("omp_cart",JSON.stringify(this.items)),document.dispatchEvent(new CustomEvent("cart_changed",{bubbles:!0},{detail:"Event change cart"}))}load_cart_from_storage(){this.items=[];var t=JSON.parse(window.localStorage.getItem("omp_cart"));if(t)for(var a in t){var e=new Item(t[a].sku,t[a].name,Number(t[a].price),Number(t[a].discounted_price),t[a].image,Number(t[a].quantity));this.items.push(e)}this.omp_cart_id=window.localStorage.getItem("omp_cart_id"),this.omp_cart_id||(this.omp_cart_id=this.uuidv4(),window.localStorage.setItem("omp_cart_id",this.omp_cart_id))}}var cart=new Cart,cart_quantity_els=document.querySelectorAll('[data-cart-quantity="true"]');cart_quantity_els.forEach((t=>{t.innerHTML=cart.total_quantity()})),document.addEventListener("cart_changed",(t=>{cart_quantity_els.length>0&&(cart_quantity_els[0].innerHTML=cart.total_quantity())}));var add_to_cart_btns=document.querySelectorAll('[data-action="add_to_cart"]'),checkout_btns=document.querySelectorAll('[data-action="checkout"]'),add_to_cart_handler=function(t){var a,e,r,i,c,n,s,o=this,d="checkout"==o.getAttribute("data-action");o.getAttribute("data-action");if(a=o.getAttribute("data-name"),e=o.getAttribute("data-sku"),r=Number(o.getAttribute("data-quantity")),i=Number(o.getAttribute("data-price")),c=Number(o.getAttribute("data-discounted-price")),n=o.getAttribute("data-image"),s=o.getAttribute("data-append-to-cart"),console.log("clicked",d),d&&"false"==s&&cart.clear_cart(),a&&e&&r&&i&&c){var u=new Item(e,a,i,c,n,r);cart.add_item_to_cart(u)}d&&(console.log("aa"),window.location="/checkout?cart="+window.localStorage.getItem("omp_cart_id"))};add_to_cart_btns.forEach((t=>{t.addEventListener("click",add_to_cart_handler)})),checkout_btns.forEach((t=>{t.addEventListener("click",add_to_cart_handler)}));
