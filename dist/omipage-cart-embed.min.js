"use strict";!function(t){class e{constructor(t,e,a,i,r,n){this.sku=t,this.name=e,this.price=a,this.discounted_price=i,this.image=r,this.quantity=n}total_amount(){return self.quantity*self.price}increase_quantity(t=1){this.quantity+=t}}t.Cart=class{constructor(){this.items=[],this.load_cart_from_storage()}uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}add_item_to_cart(t){var e=this.find(t.sku);if(!e)return this.items.push(t),void this.save_cart();var a=this.items.indexOf(e);e.increase_quantity(t.quantity),this.items[a]=e,this.save_cart()}find(t){return this.items.find((e=>e.sku==t))}total_quantity(){var t=0;return this.items.forEach(((e,a)=>{t+=e.quantity})),t}has(t){return null!=this.find(t)}clear_cart(){this.items=[],this.save_cart()}save_cart(){t.localStorage.setItem("omp_cart",JSON.stringify(this.items)),document.dispatchEvent(new CustomEvent("cart_changed",{bubbles:!0},{detail:"Event change cart"}))}load_cart_from_storage(){this.items=[];var a=JSON.parse(t.localStorage.getItem("omp_cart"));if(a)for(var i in a){var r=new e(a[i].sku,a[i].name,Number(a[i].price),Number(a[i].discounted_price),a[i].image,Number(a[i].quantity));this.items.push(r)}this.omp_cart_id=t.localStorage.getItem("omp_cart_id"),this.omp_cart_id||(this.omp_cart_id=this.uuidv4(),t.localStorage.setItem("omp_cart_id",this.omp_cart_id))}},t.Omipage=class{constructor(t){this.cart=t,this.cart_quantity_els=document.querySelectorAll('[data-cart-quantity="true"]'),this.add_to_cart_btns=document.querySelectorAll('[data-action="add_to_cart"]'),this.checkout_btns=document.querySelectorAll('[data-action="checkout"]'),this.store_page_key(),this.store_page_title(),this.store_utm_tag()}display_quantity_to_view(){var t=this;this.cart_quantity_els.forEach((e=>{e.innerHTML=t.cart.total_quantity()}))}binding_cart_quantity(){var t=this;t.display_quantity_to_view(),document.addEventListener("cart_changed",(e=>{t.display_quantity_to_view()}))}binding_add_to_cart_button(){var a=this,i=function(i){var r,n,s,o,c,u,_,m=this,d="checkout"==m.getAttribute("data-action");m.getAttribute("data-action");if(r=m.getAttribute("data-name"),n=m.getAttribute("data-sku"),s=Number(m.getAttribute("data-quantity")),o=Number(m.getAttribute("data-price")),c=Number(m.getAttribute("data-discounted-price")),u=m.getAttribute("data-image"),_=m.getAttribute("data-append-to-cart"),d&&"false"==_&&a.cart.clear_cart(),r&&n&&s&&o&&c){var h=new e(n,r,o,c,u,s);a.cart.add_item_to_cart(h)}d&&(t.location="/checkout?cart="+t.localStorage.getItem("omp_cart_id"))};this.add_to_cart_btns.forEach((t=>{t.addEventListener("click",i)})),this.checkout_btns.forEach((t=>{t.addEventListener("click",i)}))}get_meta(t){const e=document.getElementsByTagName("meta");for(let a=0;a<e.length;a++)if(e[a].getAttribute("name")===t)return e[a].getAttribute("content");return""}store_page_key(){localStorage.setItem("omp_key",this.get_meta("omp_key"))}store_page_title(){localStorage.setItem("omp_title",document.title)}parse_query_string(t){for(var e=t.split("&"),a={},i=0;i<e.length;i++){var r=e[i].split("="),n=decodeURIComponent(r[0]),s=decodeURIComponent(r[1]);if(void 0===a[n])a[n]=decodeURIComponent(s);else if("string"==typeof a[n]){var o=[a[n],decodeURIComponent(s)];a[n]=o}else a[n].push(decodeURIComponent(s))}return a}store_utm_tag(){var e=t.location.search.substring(1),a=this.parse_query_string(e),i={utm_source:a.utm_source,utm_medium:a.utm_medium,utm_campaign:a.utm_campaign,utm_term:a.utm_term,utm_content:a.utm_content};localStorage.setItem("utm_tag",JSON.stringify(i))}}}(window);var cart=new Cart,omipage=new Omipage(cart);omipage.binding_add_to_cart_button(),omipage.binding_cart_quantity();
